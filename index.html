<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CloudsAI Assistant</title>
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Heroicons for close icon -->
    <script src="https://unpkg.com/@heroicons/react@2.0.11/outline/index.js"></script>
    <!-- Chart.js for speedometer -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-gauge@0.3.0/dist/chartjs-gauge.min.js"></script>
    <style>
        /* Custom gradient background */
        body {
            background: linear-gradient(135deg, #6a11cb, #2575fc);
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }
        
        /* Custom scrollbar for chatbox */
        #chatbox::-webkit-scrollbar {
            width: 6px;
        }
        
        #chatbox::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        #chatbox::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        #chatbox::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Smooth animations */
        .smooth-transition {
            transition: all 0.3s ease-in-out;
        }
        
        /* Horizontal scrollable pills container */
        #suggestions {
            display: flex;
            overflow-x: auto;
            gap: 8px;
            padding: 8px 3px;
            margin-bottom: 8px;
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE and Edge */
        }
        
        /* Hide scrollbar for suggestions */
        #suggestions::-webkit-scrollbar {
            display: none;
        }
        
        /* Pill styling */
        .suggestion-pill {
            flex: 0 0 auto;
            padding: 8px 16px;
            background-color: #e0e7ff;
            border-radius: 20px;
            cursor: pointer;
            color: #4f46e5;
            font-size: 14px;
            white-space: nowrap;
            transition: background-color 0.2s ease;
        }
        
        .suggestion-pill:hover {
            background-color: #c7d2fe;
        }
        
        /* Question items in chat */
        .question-item {
            display: block;
            margin: 6px 0;
            padding: 8px 12px;
            background-color: #e0e7ff;
            border-radius: 12px;
            color: #4f46e5;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
            word-break: break-word;
        }
        
        .question-item:hover {
            background-color: #c7d2fe;
        }
        
        .questions-container {
            margin: 8px 0;
        }
        
        #assistantButton {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #edecf0;
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        #assistantButton:hover {
            transform: scale(1.05);
            /* box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15); */
            box-shadow: 2px 0px 2px black;
        }
        
        /* Close icon styling */
        .close-icon {
            position: absolute;
            top: 16px;
            right: 16px;
            cursor: pointer;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: background-color 0.2s ease;
        }
        
        .close-icon:hover {
            background-color: rgba(0, 0, 0, 0.9);
        }
        
        /* Chatbot interface styling */
        #chatbotInterface {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 90%;
            max-width: 400px;
            height: 85vh;
            max-height: 800px;
            display: none;
            z-index: 1001;
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            flex-direction: column;
        }
        
        /* Chatbox styling */
        #chatbox {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            background-color: #f9fafb;
        }
        
        /* Input and suggestions container */
        .input-container {
            padding: 12px 16px;
            background-color: #ffffff;
            border-top: 1px solid #e5e7eb;
            position: relative;
        }
        
        /* Bucket icon styling */
        .bucket-icon {
            width: 42px;
            height: 42px;
            background: linear-gradient(135deg, #4f46e5, #6366f1);
            border-radius: 50%;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-right: 10px;
            flex-shrink: 0;
            position: relative;
            z-index: 1;
        }
        
        .bucket-icon:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(79, 70, 229, 0.3);
        }
        
        /* Question Panel Styling */
        .question-panel {
            position: absolute;
            bottom: 60px;
            left: 0;
            width: 280px;
            max-height: 250px;
            overflow-y: auto;
            background-color: white;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            border-radius: 12px;
            display: none;
            flex-direction: column;
            z-index: 10;
            border: 1px solid #e5e7eb;
        }
        
        .question-panel.active {
            display: flex;
            animation: fadeIn 0.2s ease;
        }
        
        .panel-header {
            padding: 12px 16px;
            font-weight: 600;
            color: #4f46e5;
            border-bottom: 1px solid #e5e7eb;
            font-size: 15px;
            position: sticky;
            top: 0;
            background: white;
            z-index: 1;
        }
        
        .question-list {
            display: flex;
            flex-direction: column;
            padding: 4px 0;
        }
        
        .question-list button {
            padding: 12px 16px;
            border: none;
            background: none;
            text-align: left;
            width: 100%;
            cursor: pointer;
            font-size: 14px;
            color: #444;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            white-space: normal;
            word-break: break-word;
            border-radius: 0;
            margin: 0;
        }
        
        .question-list button:hover {
            background-color: #f5f8ff;
        }
        
        .question-list button::before {
            content: "â€¢";
            color: #4f46e5;
            margin-right: 8px;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Input container flex layout */
        .input-flex-container {
            display: flex;
            align-items: center;
        }
        
        /* Form styling */
        .form-container {
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            margin: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .form-title {
            text-align: center;
            font-size: 1.25rem;
            font-weight: 600;
            color: #4f46e5;
            margin-bottom: 1rem;
        }
        
        .form-subtitle {
            text-align: center;
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #4f46e5;
            font-size: 0.875rem;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 0.625rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.2);
        }
        
        .submit-btn {
            background-color: #4f46e5;
            color: white;
            border: none;
            padding: 0.625rem 1rem;
            border-radius: 0.375rem;
            cursor: pointer;
            width: 100%;
            font-weight: 500;
            font-size: 0.875rem;
            transition: background-color 0.2s;
            margin-top: 0.5rem;
        }
        
        .submit-btn:hover {
            background-color: #4338ca;
        }
        
        /* Enhanced WhatsApp button styling */
        .whatsapp-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background-color: #25D366;
            color: white;
            padding: 10px 16px;
            border-radius: 24px;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(37, 211, 102, 0.3);
            margin: 8px 0;
        }
        
        .whatsapp-btn:hover {
            background-color: #128C7E;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 211, 102, 0.4);
        }
        
        .whatsapp-icon {
            margin-right: 8px;
            width: 20px;
            height: 20px;
            transition: transform 0.3s ease;
        }
        
        .whatsapp-btn:hover .whatsapp-icon {
            transform: scale(1.1);
        }
        
        /* WhatsApp button in chat header */
        .header-whatsapp {
            position: absolute;
            right: 60px;
            top: 16px;
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .header-whatsapp:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        /* Mode selection slider styling */
        .slider-container {
            margin-bottom: 1.5rem;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #4f46e5;
        }

        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e5e7eb;
            outline: none;
            transition: all 0.3s ease;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4f46e5;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4f46e5;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .slider:hover {
            background: #d1d5db;
        }

        .slider:hover::-webkit-slider-thumb {
            background: #4338ca;
            transform: scale(1.1);
        }

        .slider:hover::-moz-range-thumb {
            background: #4338ca;
            transform: scale(1.1);
        }

        .slider-option {
            font-size: 0.75rem;
            color: #6b7280;
        }

        
        /* Speedometer styling */
        .speedometer-container {
            position: relative;
            width: 100%;
            max-width: 300px;
            margin: 0 auto 1.5rem;
            height: 150px;
            background-color: rgb(253, 253, 253);
        }

        .speedometer-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
            font-weight: 600;
            color: #4f46e5;
        }

        /* Toggle switch styling */
        .toggle-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .toggle-group {
            flex: 1;
            margin: 0 8px;
            text-align: center;
        }

        .toggle-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #4f46e5;
            font-size: 0.875rem;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #e5e7eb;
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: #4f46e5;
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        .toggle-option {
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 4px;
        }

        /* Result content styling */
        .result-content {
            background-color: #f9fafb;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid #e5e7eb;
        }

        .result-title {
            font-weight: 600;
            color: #4f46e5;
            margin-bottom: 0.5rem;
        }

        .result-description {
            color: #6b7280;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .know-more-btn {
            background-color: #e0e7ff;
            color: #4f46e5;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.875rem;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
        }

        .know-more-btn:hover {
            background-color: #c7d2fe;
        }

        .know-more-btn svg {
            margin-left: 0.5rem;
            transition: transform 0.2s;
        }

        .know-more-btn:hover svg {
            transform: translateX(2px);
        }

        /* Know More Details Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1100;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            max-width: 90%;
            width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #4f46e5;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280;
        }

        .modal-body {
            color: #4b5563;
            line-height: 1.6;
        }

        /* Loading indicator */
        .loading-indicator {
            display: inline-block;
            position: relative;
            width: 80px;
            height: 20px;
        }

        .loading-indicator div {
            position: absolute;
            top: 5px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #4f46e5;
            animation-timing-function: cubic-bezier(0, 1, 1, 0);
        }

        .loading-indicator div:nth-child(1) {
            left: 8px;
            animation: loading-indicator1 0.6s infinite;
        }

        .loading-indicator div:nth-child(2) {
            left: 8px;
            animation: loading-indicator2 0.6s infinite;
        }

        .loading-indicator div:nth-child(3) {
            left: 32px;
            animation: loading-indicator2 0.6s infinite;
        }

        .loading-indicator div:nth-child(4) {
            left: 56px;
            animation: loading-indicator3 0.6s infinite;
        }

        @keyframes loading-indicator1 {
            0% {
                transform: scale(0);
            }
            100% {
                transform: scale(1);
            }
        }

        @keyframes loading-indicator3 {
            0% {
                transform: scale(1);
            }
            100% {
                transform: scale(0);
            }
        }

        @keyframes loading-indicator2 {
            0% {
                transform: translate(0, 0);
            }
            100% {
                transform: translate(24px, 0);
            }
        }

        /* Responsive adjustments */
        /* Mobile (default) */
        
        /* Tablet (768px and up) */
        @media (min-width: 768px) {
            #chatbotInterface {
                max-width: 450px;
                height: 80vh;
            }
            
            .question-panel {
                width: 300px;
            }
            
            .bucket-icon {
                width: 44px;
                height: 44px;
            }
            
            #userInput {
                padding: 12px;
                font-size: 15px;
            }
            
            .form-container {
                padding: 24px;
            }
            
            .form-title {
                font-size: 1.5rem;
            }

            .speedometer-container {
                max-width: 250px;
                height: 180px;
            }
        }
        
        /* Laptop (1024px and up) */
        @media (min-width: 1024px) {
            #chatbotInterface {
                max-width: 500px;
                height: 75vh;
            }
            
            .question-panel {
                width: 320px;
            }
            
            .bucket-icon {
                width: 46px;
                height: 46px;
            }
            
            #userInput {
                padding: 14px;
                font-size: 16px;
            }
        }
        
        /* Small mobile devices (below 640px) */
        @media (max-width: 640px) {
            #chatbotInterface {
                width: 100%;
                height: 100%;
                max-width: none;
                max-height: none;
                bottom: 0;
                right: 0;
                border-radius: 0;
            }
            
            .question-panel {
                position: fixed;
                bottom: 80px;
                left: 16px;
                right: 16px;
                width: calc(100% - 32px);
                max-width: none;
            }
            
            .panel-header {
                padding: 14px 16px;
                font-size: 16px;
            }
            
            .question-list button {
                padding: 14px 16px;
                font-size: 15px;
            }
            
            .bucket-icon {
                width: 44px;
                height: 44px;
            }
            
            #userInput {
                padding: 14px;
                font-size: 15px;
            }
            
            .header-whatsapp {
                right: 50px;
                top: 14px;
                width: 32px;
                height: 32px;
            }

            .speedometer-container {
                max-width: 200px;
                height: 150px;
            }

            .toggle-container {
                flex-direction: column;
            }

            .toggle-group {
                margin: 8px 0;
            }
        }
        
        /* Prevent body scrolling when chatbot is open */
        body.chatbot-open {
            overflow: hidden;
        }
        .whatsapp-button {
            position: absolute;
            bottom: 20px;
            right: 60px;
            top:13px;
            width: 43px;
            height: 43px;
            background-color: #25D366;
            border-radius: 50%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            animation: pulse 2s infinite;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .whatsapp-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .whatsapp-button img {
            width: 36px;
            height: 36px;
        }

     
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(37, 211, 102, 0.7);
            }
            70% {
                box-shadow: 0 0 0 15px rgba(37, 211, 102, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(37, 211, 102, 0);
            }
        }

        /* Enhanced speedometer styling */
        .speedometer-gauge {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .speedometer-needle {
            position: absolute;
            width: 4px;
            height: 60%;
            background: #4f46e5;
            left: 50%;
            top: 20%;
            transform-origin: 50% 100%;
            transform: translateX(-50%) rotate(0deg);
            transition: transform 0.5s ease-out;
            z-index: 10;
            border-radius: 4px;
        }

        .speedometer-needle::after {
            content: '';
            position: absolute;
            width: 12px;
            height: 12px;
            background: #4f46e5;
            border-radius: 50%;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
        }

        .speedometer-marks {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .speedometer-mark {
            position: absolute;
            width: 2px;
            height: 10px;
            background: #6b7280;
            left: 50%;
            bottom: 20%;
            transform-origin: 50% 100%;
        }

        .speedometer-label {
            position: absolute;
            font-size: 0.7rem;
            color: #6b7280;
            transform: translateX(-50%);
            bottom: 10%;
        }
    </style>
</head>

<body>
    <!-- Floating AI Assistant Button -->
    <button id="assistantButton" class="smooth-transition">
        <img src="./excited.png">
    </button>

    <!-- Chatbot Interface -->
    <div id="chatbotInterface" class="bg-white flex flex-col">
        <!-- Chatbot Header with WhatsApp icon -->
        <div class="bg-gradient-to-r from-purple-600 to-blue-500 py-3 px-6 relative">
            <h1 class="text-2xl font-bold text-white">CloudsAI Assistant</h1>
            <p class="text-sm text-purple-200">Your AI-powered assistant</p>
            
            <!-- WhatsApp icon in header -->
            <a class="whatsapp-button" href="https://wa.me/+919896842161" target="_blank">
                <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp">
            </a>
        
            <!-- Close Icon -->
            <div class="close-icon" id="closeButton">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </div>
        </div>

        <!-- Chatbox -->
        <div id="chatbox">
            <!-- Sign-in form will appear here on first open -->
            <div id="signinForm" class="form-container">
                <h2 class="form-title">Welcome to CloudsAI</h2>
                <p class="form-subtitle">Please provide some basic information to get started</p>
                
                <div class="form-group">
                    <label for="userName">Full Name</label>
                    <input type="text" id="userName" placeholder="Enter your full name" required>
                </div>
                
                <div class="form-group">
                    <label for="userEmail">Email</label>
                    <input type="email" id="userEmail" placeholder="Enter your email" required>
                </div>
                
                <div class="form-group">
                    <label for="userContact">Contact Number</label>
                    <input type="tel" id="userContact" placeholder="Enter your phone number" required>
                </div>
                
                <div class="form-group">
                    <label for="userAge">Age</label>
                    <input type="number" id="userAge" placeholder="Enter your age" min="10" max="99" required>
                </div>
                
                <div class="form-group">
                    <label for="userStream">Stream</label>
                    <select id="userStream" required>
                        <option value="" disabled selected>Select your stream</option>
                        <option value="PCM">PCM (Physics, Chemistry, Maths)</option>
                        <option value="PCB">PCB (Physics, Chemistry, Biology)</option>
                        <option value="Arts">Arts</option>
                        <option value="Commerce">Commerce</option>
                        <option value="PMNB">PMNB (Physics, Maths, Biology)</option>
                        <option value="PS">PS (Political Science)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="userCity">City</label>
                    <select id="userCity" required>
                        <option value="" disabled selected>Select your city</option>
                        <option value="Delhi">Delhi</option>
                        <option value="Mumbai">Mumbai</option>
                        <option value="Bangalore">Bangalore</option>
                        <option value="Hyderabad">Hyderabad</option>
                        <option value="Chennai">Chennai</option>
                        <option value="Kolkata">Kolkata</option>
                        <option value="Pune">Pune</option>
                        <option value="Jaipur">Jaipur</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <button id="submitForm" class="submit-btn">Continue to Mode Selection</button>
            </div>
            
            <!-- Mode selection form (hidden initially) -->
            <div id="modeForm" class="form-container" style="display: none;">
                <h2 class="form-title">Select Your Learning Mode</h2>
                <p class="form-subtitle">Adjust the settings to customize your learning experience</p>
                
                <!-- Toggle switches for mode selection -->
                <div class="toggle-container">
                    <div class="toggle-group">
                        <span class="toggle-label">Academics</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="academicsToggle">
                            <span class="toggle-slider"></span>
                        </label>
                        <div class="flex justify-between">
                            <span class="toggle-option">Online</span>
                            <span class="toggle-option">Offline</span>
                        </div>
                    </div>
                    
                    <div class="toggle-group">
                        <span class="toggle-label">Industry Readiness</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="irToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <div class="flex justify-between">
                            <span class="toggle-option">Online</span>
                            <span class="toggle-option">Offline</span>
                        </div>
                    </div>
                </div>
                
                <!-- Enhanced Speedometer -->
                <div class="speedometer-container">
                    <div class="speedometer-gauge">
                        <div class="speedometer-marks" id="speedometerMarks"></div>
                        <div class="speedometer-needle" id="speedometerNeedle"></div>
                        <div class="speedometer-value" id="speedometerValue">75%</div>
                    </div>
                </div>
                
                <!-- Result Content -->
                <div class="result-content" id="resultContent">
                    <h3 class="result-title">Recommended: Online Academics + Offline IR</h3>
                    <p class="result-description">This combination provides the flexibility of online learning for academics with the hands-on experience of offline industry training.</p>
                    <button class="know-more-btn" id="knowMoreBtn">
                        Know More
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
                        </svg>
                    </button>
                </div>
                
                <!-- WhatsApp group link -->
                <div class="text-center">
                    <p class="text-sm text-gray-600 mb-2">Join our WhatsApp group for updates:</p>
                    <a href="https://chat.whatsapp.com/YOUR_GROUP_LINK" class="whatsapp-btn" target="_blank">
                        <svg xmlns="http://www.w3.org/2000/svg" class="whatsapp-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-6.29 5.362c-.173.198-.341.52-.5.644-.161.125-.346.186-.495.186-.124 0-.248-.03-.372-.074-.421-.15-1.24-.619-2.336-1.773-.865-.894-1.45-1.99-1.618-2.326-.173-.341-.198-.578-.124-.744.075-.173.421-.52.644-.678.223-.161.347-.198.52-.198.174 0 .347.037.52.161.173.124.744.818.793.868.05.05.099.074.198.037.099-.037.421-.161.744-.248.324-.087.595-.037.768.099.174.136.744.818.818.992.075.174.075.347-.024.521"/>
                        </svg>
                        Need more help?
                    </a>
                </div>
                
                <button id="submitMode" class="submit-btn">Start Chatting</button>
            </div>
        </div>

        <!-- Input and Suggestions (hidden initially) -->
        <div class="input-container" id="chatInputContainer" style="display: none;">
            <!-- Suggestions above the input box -->
            <div id="suggestions" class="hidden"></div>
            <div class="input-flex-container">
                <!-- Bucket icon container -->
                <div class="icon-container relative">
                    <div class="bucket-icon" id="bucketIcon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z" />
                        </svg>
                    </div>
                    <!-- Question panel -->
                    <div class="question-panel" id="questionPanel">
                        <div class="panel-header">Question Categories</div>
                        <div class="question-list" id="mainQuestionList"></div>
                    </div>
                </div>
                <input type="text" id="userInput" placeholder="Type your question..." class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent smooth-transition" />
            </div>
        </div>
    </div>

    <!-- Know More Modal -->
    <div class="modal-overlay" id="knowMoreModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Program Details</h3>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
                Loading details...
            </div>
        </div>
    </div>

    <script>
        // Sample JSON data for questions and answers
        const qaData = [{
            "question": "What is the AIR program?",
            "answer": "The AIR program is an industry-ready training initiative designed to equip students with advanced skills in AI, ML, Cloud Computing, and Data Science."
        }, {
            "question": "What does AIR stand for?",
            "answer": "The AIR program is an industry-ready training initiative designed to equip students with advanced skills in AI, ML, Cloud Computing, and Data Science."
        }, {
            "question": "What is CloudsAI AIR?",
            "answer": "The AIR program is an industry-ready training initiative designed to equip students with advanced skills in AI, ML, Cloud Computing, and Data Science."
        }, {
            "question": "How does the AIR program help students?",
            "answer": "The AIR program helps students by providing hands-on training, real-world projects, mentorship from industry experts, and career support to make them job-ready."
        }, {
            "question": "How is the AIR program different from other industry-ready programs?",
            "answer": "The AIR program stands out by offering a curriculum designed by industry experts, real-time projects, personalized mentorship, and strong placement support."
        }, {
            "question": "What is the difference between AIR2Y, AIR3Y, and AIR4Y?",
            "answer": "The difference between AIR2Y, AIR3Y, and AIR4Y is the duration and depth of training. AIR2Y is a two-year program, AIR3Y spans three years, and AIR4Y is a four-year advanced industry training program."
        }, {
            "question": "Who is eligible for the AIR program?",
            "answer": "The AIR program is open to students, working professionals, and career changers interested in AI, ML, Cloud Computing, and Data Science."
        }, {
            "question": "What are the eligibility criteria for the AIR program?",
            "answer": "Candidates must have a passion for technology, basic programming knowledge, and a willingness to learn AI and ML concepts."
        }, {
            "question": "Can students from non-technical backgrounds apply for AIR?",
            "answer": "Yes, students from any background can apply, provided they are willing to learn technical concepts and complete the required coursework."
        }, {
            "question": "Do I need prior programming knowledge to join the AIR program?",
            "answer": "Basic programming knowledge is helpful but not mandatory. The program includes foundational courses for beginners."
        }, {
            "question": "Can a high school student join the AIR program?",
            "answer": "Yes, high school students with a keen interest in AI and ML can apply."
        }, {
            "question": "Is the AIR program open to international students?",
            "answer": "Yes, the AIR program is open to students from all countries."
        }, {
            "question": "Are there any age restrictions for joining the AIR program?",
            "answer": "No, the AIR program is open to learners of all ages."
        }, {
            "question": "Can working professionals enroll in the AIR program?",
            "answer": "Yes, the AIR program is designed for both students and working professionals."
        }, {
            "question": "Can I join the AIR program if I already have a job?",
            "answer": "Yes, you can enroll while working as the program offers flexible learning options."
        }, {
            "question": "Can I apply for the AIR program if I am currently in college?",
            "answer": "Yes, college students can apply and take the program alongside their studies."
        }, {
            "question": "Do I need to take an entrance test for the AIR program?",
            "answer": "No, the AIR program does not require an entrance test. Admission is based on application review."
        }, {
            "question": "Can I enroll in the AIR program part-time?",
            "answer": "Yes, part-time enrollment options are available."
        }, {
            "question": "Is work experience required for the AIR program?",
            "answer": "No, work experience is not mandatory for enrollment."
        }, {
            "question": "Can I switch my specialization after enrolling in the AIR program?",
            "answer": "Yes, you can switch specializations within a specified timeframe."
        }, {
            "question": "Is prior AI knowledge necessary for the AIR program?",
            "answer": "No, the AIR program covers AI fundamentals from scratch."
        }, {
            "question": "What is the total cost of the AIR program?",
            "answer": "The total cost varies based on the program duration and specialization. Please visit our official website for the latest fee structure."
        }, {
            "question": "Can I pay the AIR program fees in installments?",
            "answer": "Yes, the AIR program offers installment-based payment plans."
        }, {
            "question": "What is fee Structure",
            "answer": "This is fee Structure .........."
        }, {
            "question": "Are there any scholarships for the AIR program?",
            "answer": "Yes, merit-based and need-based scholarships are available."
        }, {
            "question": "Is financial aid available for the AIR program?",
            "answer": "Yes, financial aid options are available based on eligibility."
        }, {
            "question": "Do you offer corporate sponsorships for the AIR program?",
            "answer": "Yes, corporate sponsorships may be available for eligible candidates."
        }, {
            "question": "What is the refund policy for the AIR program?",
            "answer": "The refund policy depends on the stage of withdrawal. Please refer to our official guidelines for details."
        }, {
            "question": "Are there any hidden charges in the AIR program?",
            "answer": "No, all costs are transparently mentioned in the fee structure."
        }, {
            "question": "Do you provide EMI options for the AIR program fees?",
            "answer": "Yes, EMI options are available through partnered financial institutions."
        }, {
            "question": "Is there a discount for early registration in the AIR program?",
            "answer": "Yes, early registration discounts may be available. Please check our website for current offers."
        }, {
            "question": "Are there additional costs for study materials in the AIR program?",
            "answer": "No, study materials are included in the program fees."
        }, {
            "question": "Do I need to pay extra for certification after the AIR program?",
            "answer": "No, certification is included in the program fees."
        }, {
            "question": "Can I get a fee waiver for the AIR program?",
            "answer": "Fee waivers may be available based on merit or financial need."
        }, {
            "question": "Are government subsidies available for the AIR program?",
            "answer": "Some government subsidy programs may be applicable. Please check with our admissions team."
        }, {
            "question": "Is there an application fee for the AIR program?",
            "answer": "No, the application process is free of charge."
        }, {
            "question": "Do I need to make an upfront payment for the AIR program?",
            "answer": "A small initial deposit may be required to confirm enrollment."
        }, {
            "question": "Can I get employer reimbursement for the AIR program?",
            "answer": "Some employers may offer reimbursement for professional development programs like AIR. Check with your company."
        }, {
            "question": "Is there a referral discount for the AIR program?",
            "answer": "Yes, referral discounts may be available for successful referrals."
        }, {
            "question": "What is the CloudsAI Chatbot?",
            "answer": "The CloudsAI Chatbot is an AI-powered assistant designed to answer queries related to the AIR program and AI/ML topics."
        }, {
            "question": "How does the CloudsAI Chatbot work?",
            "answer": "The chatbot uses Natural Language Processing (NLP) and a knowledge base to understand and respond to user queries."
        }, {
            "question": "What can the CloudsAI Chatbot help me with?",
            "answer": "The chatbot can answer questions about the AIR program, eligibility, fees, curriculum, and more."
        }, {
            "question": "Is the CloudsAI Chatbot available 24/7?",
            "answer": "Yes, the chatbot is available 24/7 to assist with any inquiries."
        }, {
            "question": "Can the CloudsAI Chatbot handle complex queries?",
            "answer": "Yes, the chatbot is trained to understand and respond to a variety of detailed queries."
        }, {
            "question": "Does the CloudsAI Chatbot provide personalized responses?",
            "answer": "Yes, it tailors responses based on user queries and past interactions."
        }, {
            "question": "Can I chat with a human agent instead of the CloudsAI Chatbot?",
            "answer": "Yes, if needed, the chatbot can connect you with a human support agent."
        }, {
            "question": "How accurate is the CloudsAI Chatbot?",
            "answer": "The chatbot is trained with a large dataset and provides high accuracy in responses."
        }, {
            "question": "Does the CloudsAI Chatbot support multiple languages?",
            "answer": "Currently, it primarily supports English, but multilingual support may be available in the future."
        }, {
            "question": "Can I use the CloudsAI Chatbot on my mobile device?",
            "answer": "Yes, the chatbot is mobile-friendly and works on all devices."
        }, {
            "question": "Is the CloudsAI Chatbot free to use?",
            "answer": "Yes, the chatbot is free for answering general queries."
        }, {
            "question": "How do I access the CloudsAI Chatbot?",
            "answer": "You can access it via the official CloudsAI website or mobile app."
        }, {
            "question": "Can the CloudsAI Chatbot assist with admissions?",
            "answer": "Yes, it provides details on the application process and eligibility."
        }, {
            "question": "Does the CloudsAI Chatbot provide updates on my application status?",
            "answer": "Yes, it can check and provide updates on your application status."
        }, {
            "question": "Can the chatbot answer technical questions about AI and ML?",
            "answer": "Yes, the chatbot can answer AI and ML-related questions using its knowledge base."
        }, {
            "question": "How does the CloudsAI Chatbot improve over time?",
            "answer": "It uses machine learning to continuously learn and improve responses based on interactions."
        }, {
            "question": "Can I request new features for the CloudsAI Chatbot?",
            "answer": "Yes, user feedback is welcomed for improvements."
        }, {
            "question": "What happens if the chatbot cannot answer my question?",
            "answer": "If the chatbot cannot answer, it will provide alternative resources or connect you with support."
        }, {
            "question": "Can I reset my conversation history with the CloudsAI Chatbot?",
            "answer": "Yes, you can reset the chat to start a new session."
        }, {
            "question": "Is the CloudsAI Chatbot powered by AI?",
            "answer": "Yes, it uses AI and NLP to process and respond to queries."
        }, {
            "question": "Hello!",
            "answer": "Hi there! How can I assist you today?"
        }, {
            "question": "Can you help me?",
            "answer": "Of course! Let me know what you need help with."
        }, {
            "question": "What is your name?",
            "answer": "I'm the CloudsAI Chatbot, here to answer your questions!"
        }, {
            "question": "Thank you!",
            "answer": "You're welcome! Let me know if you need anything else."
        }, {
            "question": "Good morning!",
            "answer": "Good morning! How can I help you today?"
        }, {
            "question": "Good afternoon!",
            "answer": "Good afternoon! How can I assist you?"
        }, {
            "question": "Good evening!",
            "answer": "Good evening! How can I help you today?"
        }, {
            "question": "What do you do?",
            "answer": "I help answer your queries related to the AIR program and CloudsAI services."
        }, {
            "question": "Who created you?",
            "answer": "I was created by the CloudsAI team to assist with your inquiries."
        }, {
            "question": "Can you tell me a joke?",
            "answer": "Sure! Why did the AI go to school? To improve its neural networks!"
        }, {
            "question": "Do you like humans?",
            "answer": "Of course! I am here to help humans with their queries."
        }, {
            "question": "Can you think?",
            "answer": "I don't think like humans, but I can process and respond based on my training data."
        }, {
            "question": "Can you chat in other languages?",
            "answer": "Currently, I primarily support English"
        }, {
            "question": "How can I contact human support?",
            "answer": "If you need further assistance, I can connect you with a human support agent."
        }, {
            "question": "What is your purpose?",
            "answer": "My purpose is to assist users by providing accurate and helpful information about CloudsAI and the AIR program."
        }, {
            "question": "Are you smarter than a human?",
            "answer": "I have vast knowledge but lack human creativity and emotions."
        }]

        // Question categories for the bucket icon
        const questionCategories = {
            "Program Basics": [
                "What is the AIR program?",
                "What does AIR stand for?",
                "How does the AIR program help students?",
                "How is the AIR program different?"
            ],
            "Eligibility": [
                "Who is eligible for the AIR program?",
                "Can students from non-technical backgrounds apply?",
                "Do I need prior programming knowledge?",
                "Can working professionals enroll?"
            ],
            "Fees & Payments": [
                "What is the total cost of the AIR program?",
                "Can I pay the AIR program fees in installments?",
                "Are there any scholarships?",
                "What is the refund policy?"
            ],
            "Chatbot Help": [
                "What is the CloudsAI Chatbot?",
                "How does the CloudsAI Chatbot work?",
                "Can I chat with a human agent?",
                "How accurate is the chatbot?"
            ],
            "General": [
                "Hello!",
                "Can you help me?",
                "Thank you!",
                "Good morning!"
            ]
        };

        // Initialize Fuse.js
        const fuse = new Fuse(qaData, {
            keys: ["question"], // Search only in the 'question' field
            includeScore: true,
            threshold: 0.7, // Adjust for more/less strict matching
        });

        // DOM Elements
        const chatbox = document.getElementById("chatbox");
        const userInput = document.getElementById("userInput");
        const suggestions = document.getElementById("suggestions");
        const assistantButton = document.getElementById("assistantButton");
        const chatbotInterface = document.getElementById("chatbotInterface");
        const closeButton = document.getElementById("closeButton");
        const bucketIcon = document.getElementById("bucketIcon");
        const questionPanel = document.getElementById("questionPanel");
        const mainQuestionList = document.getElementById("mainQuestionList");
        const signinForm = document.getElementById("signinForm");
        const modeForm = document.getElementById("modeForm");
        const chatInputContainer = document.getElementById("chatInputContainer");
        const submitForm = document.getElementById("submitForm");
        const submitMode = document.getElementById("submitMode");
        const academicsToggle = document.getElementById("academicsToggle");
        const irToggle = document.getElementById("irToggle");
        const speedometerValue = document.getElementById("speedometerValue");
        const speedometerNeedle = document.getElementById("speedometerNeedle");
        const speedometerMarks = document.getElementById("speedometerMarks");
        const resultContent = document.getElementById("resultContent");
        const knowMoreBtn = document.getElementById("knowMoreBtn");
        const knowMoreModal = document.getElementById("knowMoreModal");
        const modalClose = document.getElementById("modalClose");
        const modalTitle = document.getElementById("modalTitle");
        const modalBody = document.getElementById("modalBody");

        // Check if user has already signed in and selected mode
        let hasSignedIn = localStorage.getItem('hasSignedIn') === 'true';
        let hasSelectedMode = localStorage.getItem('hasSelectedMode') === 'true';

        // Result content data
        const resultContents = {
            "online-online": {
                title: "Online Academics + Online IR",
                description: "Fully online program with digital learning for both academics and industry readiness.",
                score: 75,
                color: '#3b82f6', // Blue
                details: "This mode offers complete flexibility with all content delivered online. Ideal for students who need maximum schedule flexibility and can learn effectively through digital platforms."
            },
            "online-offline": {
                title: "Online Academics + Offline IR",
                description: "Flexible online academics with hands-on offline industry training.",
                score: 100,
                color: '#10b981', // Green
                details: "Our recommended option that combines the convenience of online learning for academics with the practical benefits of in-person industry training. Perfect for students who want the best of both worlds."
            },
            "offline-online": {
                title: "Offline Academics + Online IR",
                description: "Traditional classroom academics with flexible online industry training.",
                score: 50,
                color: '#ef4444', // Red
                details: "This option provides the structure of classroom learning for academics with the flexibility of online industry training. Suitable for students who prefer face-to-face academic instruction."
            },
            "offline-offline": {
                title: "Offline Academics + Offline IR",
                description: "Full in-person experience for both academics and industry readiness.",
                score: 80,
                color: '#f59e0b', // Orange
                details: "Traditional learning experience with all components delivered in-person. Best for students who thrive in structured classroom environments and benefit from direct interaction."
            }
        };

        // Initialize speedometer marks
        function initSpeedometerMarks() {
            speedometerMarks.innerHTML = '';
            
            // Create marks at 0%, 25%, 50%, 75%, 100%
            for (let i = 0; i <= 100; i += 25) {
                const mark = document.createElement('div');
                mark.className = 'speedometer-mark';
                mark.style.transform = `translateX(-50%) rotate(${i * 1.8 - 90}deg)`;
                
                const label = document.createElement('div');
                label.className = 'speedometer-label';
                label.textContent = `${i}%`;
                label.style.left = `calc(50% + ${Math.sin((i * 1.8 - 90) * Math.PI / 180) * 45}%)`;
                label.style.bottom = `calc(20% + ${Math.cos((i * 1.8 - 90) * Math.PI / 180) * 45}%)`;
                
                speedometerMarks.appendChild(mark);
                speedometerMarks.appendChild(label);
            }
        }

        // Update speedometer based on selections
        function updateSpeedometer() {
            const academicsMode = academicsToggle.checked ? 'offline' : 'online';
            const irMode = irToggle.checked ? 'offline' : 'online';
            const modeKey = `${academicsMode}-${irMode}`;
            const result = resultContents[modeKey];
            
            // Update needle position (0% = -90deg, 100% = 90deg)
            const rotation = (result.score * 1.8) - 90;
            speedometerNeedle.style.transform = `translateX(-50%) rotate(${rotation}deg)`;
            
            // Update value display
            speedometerValue.textContent = `${result.score}%`;
            speedometerValue.style.color = result.color;
            
            // Update result content
            document.querySelector('#resultContent .result-title').textContent = `Recommended: ${result.title}`;
            document.querySelector('#resultContent .result-description').textContent = result.description;
            
            // Update know more button data attribute
            knowMoreBtn.setAttribute('data-details', result.details);
            knowMoreBtn.setAttribute('data-title', result.title);
        }

        // Show details modal
        function showDetailsModal() {
            const details = knowMoreBtn.getAttribute('data-details');
            const title = knowMoreBtn.getAttribute('data-title');
            
            modalTitle.textContent = title;
            modalBody.textContent = details;
            
            knowMoreModal.classList.add('active');
            document.body.classList.add('modal-open');
        }

        // Close details modal
        function closeDetailsModal() {
            knowMoreModal.classList.remove('active');
            document.body.classList.remove('modal-open');
        }

        // Initialize question panel for bucket icon
        function initializeQuestionPanel() {
            mainQuestionList.innerHTML = '';
            Object.keys(questionCategories).forEach(category => {
                const button = document.createElement('button');
                button.textContent = category;
                button.style.whiteSpace = 'normal';
                button.style.wordBreak = 'break-word';
                button.style.textAlign = 'left';
                button.onclick = (e) => {
                    e.stopPropagation();
                    sendCategoryQuestions(category);
                };
                mainQuestionList.appendChild(button);
            });
        }

        // Toggle question panel visibility
        function toggleQuestionPanel() {
            questionPanel.classList.toggle('active');
        }

        // Send category questions when a category is selected
        function sendCategoryQuestions(category) {
            // Close the question panel
            questionPanel.classList.remove('active');

            // Add user's selection to chat
            addMessage(`You asked about: ${category}`, true);

            // Generate the bot's response with quick questions
            setTimeout(() => {
                const questions = questionCategories[category];
                let response = `Here are some common questions about <strong>${category}</strong>:<div class="questions-container">`;

                questions.forEach(question => {
                    response += `<div class="question-item" onclick="selectQuickQuestion('${question.replace(/'/g, "\\'")}')">${question}</div>`;
                });

                response += `</div>Click any question above or type your own.`;

                const botMessage = document.createElement('div');
                botMessage.className = 'mb-2 text-left';
                botMessage.innerHTML = `
                    <div class="inline-block max-w-[70%] p-3 rounded-lg bg-gray-200 text-gray-800 smooth-transition">
                        ${response}
                    </div>
                `;
                chatbox.appendChild(botMessage);

                // Scroll to the latest message
                chatbox.scrollTop = chatbox.scrollHeight;
            }, 500);
        }

        // Select a quick question from the bucket panel
        function selectQuickQuestion(question) {
            userInput.value = question;
            userInput.focus();
            handleUserInput();
        }

        // Function to display messages in the chatbox
        function addMessage(message, isUser = false) {
            const messageElement = document.createElement("div");
            messageElement.className = isUser ?
                "mb-2 text-right" :
                "mb-2 text-left";
            messageElement.innerHTML = `
                <div class="inline-block max-w-[70%] p-3 rounded-lg ${isUser
                    ? "bg-purple-500 text-white"
                    : "bg-gray-200 text-gray-800"
                } smooth-transition">
                    ${message}
                </div>
            `;
            chatbox.appendChild(messageElement);
            chatbox.scrollTop = chatbox.scrollHeight; // Auto-scroll to the latest message
        }

        // Function to show loading indicator
        function showLoadingIndicator() {
            const loadingElement = document.createElement("div");
            loadingElement.className = "mb-2 text-left";
            loadingElement.innerHTML = `
                <div class="inline-block max-w-[70%] p-3 rounded-lg bg-gray-200 text-gray-800 smooth-transition">
                    <div class="loading-indicator">
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                    </div>
                </div>
            `;
            chatbox.appendChild(loadingElement);
            chatbox.scrollTop = chatbox.scrollHeight;
            return loadingElement;
        }

        // Function to handle user input
        function handleUserInput() {
            const query = userInput.value.trim();
            if (query === "") return;

            // Add user's question to the chatbox
            addMessage(`You: ${query}`, true);

            // Show loading indicator
            const loadingElement = showLoadingIndicator();

            // Simulate processing delay (1-2 seconds)
            const processingTime = 1000 + Math.random() * 1000;
            
            setTimeout(() => {
                // Remove loading indicator
                chatbox.removeChild(loadingElement);
                
                // Search for matching questions using Fuse.js
                const results = fuse.search(query);

                if (results.length > 0) {
                    // Display the best match answer
                    const bestMatch = results[0].item;
                    addMessage(`CloudsAI: ${bestMatch.answer}`);
                    
                } else {
                    addMessage("CloudsAI: Sorry, I don't understand that question. Would you like to <a href='https://chat.whatsapp.com/YOUR_GROUP_LINK' class='whatsapp-btn' target='_blank' style='display: inline-flex; padding: 6px 12px; font-size: 13px; margin-left: 5px;'><svg xmlns='http://www.w3.org/2000/svg' class='whatsapp-icon' viewBox='0 0 24 24' fill='currentColor' style='width: 14px; height: 14px; margin-right: 5px;'><path d='M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-6.29 5.362c-.173.198-.341.52-.5.644-.161.125-.346.186-.495.186-.124 0-.248-.03-.372-.074-.421-.15-1.24-.619-2.336-1.773-.865-.894-1.45-1.99-1.618-2.326-.173-.341-.198-.578-.124-.744.075-.173.421-.52.644-.678.223-.161.347-.198.52-.198.174 0 .347.037.52.161.173.124.744.818.793.868.05.05.099.074.198.037.099-.037.421-.161.744-.248.324-.087.595-.037.768.099.174.136.744.818.818.992.075.174.075.347-.024.521'/></svg>Chat with us</a> instead?");
                }

                // Clear input
                userInput.value = "";
            }, processingTime);
        }

        // Function to show auto-suggestions as pills
        function showSuggestions(query) {
            if (query === "") {
                suggestions.classList.add("hidden");
                return;
            }

            const results = fuse.search(query);
            suggestions.innerHTML = ""; // Clear previous suggestions

            if (results.length > 0) {
                results.slice(0, 5).forEach((result) => {
                    const pill = document.createElement("div");
                    pill.className = "suggestion-pill smooth-transition";
                    pill.textContent = result.item.question;
                    pill.addEventListener("click", () => {
                        userInput.value = result.item.question;
                        suggestions.classList.add("hidden");
                        handleUserInput();
                    });
                    suggestions.appendChild(pill);
                });
                suggestions.classList.remove("hidden");
            } else {
                suggestions.classList.add("hidden");
            }
        }

        // Handle form submission
        submitForm.addEventListener('click', function() {
            const name = document.getElementById('userName').value;
            const email = document.getElementById('userEmail').value;
            const contact = document.getElementById('userContact').value;
            const age = document.getElementById('userAge').value;
            const stream = document.getElementById('userStream').value;
            const city = document.getElementById('userCity').value;
            
            if (!name || !email || !contact || !age || !stream || !city) {
                alert('Please fill in all fields');
                return;
            }
            
            // Store user data (in a real app, you would send this to a server)
            const userData = {
                name,
                email,
                contact,
                age,
                stream,
                city
            };

            localStorage.setItem('userData', JSON.stringify(userData));
            // Hide sign-in form and show mode selection
            signinForm.style.display = 'none';
            modeForm.style.display = 'block';
            
            // Initialize speedometer after form is shown
            setTimeout(initSpeedometerMarks, 100);
            updateSpeedometer();
    });

localStorage.clear()
        // Handle mode selection submission
        submitMode.addEventListener('click', function() {
            const academicsMode = academicsToggle.checked ? 'offline' : 'online';
            const irMode = irToggle.checked ? 'offline' : 'online';
            
            // Store mode selection
            const userData = JSON.parse(localStorage.getItem('userData'));
            userData.programMode = `${academicsMode}-${irMode}`;
            localStorage.setItem('userData', JSON.stringify(userData));
            localStorage.setItem('hasSelectedMode', 'true');
            localStorage.setItem('hasSignedIn', 'true');
            hasSelectedMode = true;
            hasSignedIn = true;
            
            // Hide mode form and show chat interface
            modeForm.style.display = 'none';
            chatInputContainer.style.display = 'block';
            
            // Add welcome message with WhatsApp prompt
            addMessage(`CloudsAI: Welcome, ${userData.name}! How can I help you today?`);
            setTimeout(() => {
                addMessage(`CloudsAI: Need immediate help? <a href="https://chat.whatsapp.com/YOUR_GROUP_LINK" class="whatsapp-btn" target="_blank" style="display: inline-flex; margin-left: 8px;">
                    <svg xmlns="http://www.w3.org/2000/svg" class="whatsapp-icon" viewBox="0 0 24 24" fill="currentColor" style="width: 16px; height: 16px; margin-right: 6px;">
                        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-6.29 5.362c-.173.198-.341.52-.5.644-.161.125-.346.186-.495.186-.124 0-.248-.03-.372-.074-.421-.15-1.24-.619-2.336-1.773-.865-.894-1.45-1.99-1.618-2.326-.173-.341-.198-.578-.124-.744.075-.173.421-.52.644-.678.223-.161.347-.198.52-.198.174 0 .347.037.52.161.173.124.744.818.793.868.05.05.099.074.198.037.099-.037.421-.161.744-.248.324-.087.595-.037.768.099.174.136.744.818.818.992.075.174.075.347-.024.521"/>
                    </svg>
                    Join our WhatsApp
                </a>`);
            }, 500);
            
            // Focus the input field for immediate chatting
            setTimeout(() => {
                userInput.focus();
            }, 100);
        });

        // Toggle chatbot visibility
        assistantButton.addEventListener("click", () => {
            chatbotInterface.style.display = "flex";
            assistantButton.style.display = "none";
            document.body.classList.add('chatbot-open');
            
            // Show appropriate form based on user progress
            if (!hasSignedIn) {
                signinForm.style.display = 'block';
                modeForm.style.display = 'none';
                chatInputContainer.style.display = 'none';
            } else if (!hasSelectedMode) {
                signinForm.style.display = 'none';
                modeForm.style.display = 'block';
                chatInputContainer.style.display = 'none';
                // Initialize speedometer when showing mode form
                setTimeout(initSpeedometerMarks, 100);
                updateSpeedometer();
            } else {
                signinForm.style.display = 'none';
                modeForm.style.display = 'none';
                chatInputContainer.style.display = 'block';
            }
        });

        // Close chatbot
        closeButton.addEventListener("click", () => {
            chatbotInterface.style.display = "none";
            assistantButton.style.display = "flex";
            document.body.classList.remove('chatbot-open');
        });

        // Bucket icon click handler
        bucketIcon.addEventListener("click", (e) => {
            e.stopPropagation();
            toggleQuestionPanel();
        });

        // Close question panel when clicking outside
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.icon-container') && !event.target.closest('.question-panel') && questionPanel.classList.contains('active')) {
                questionPanel.classList.remove('active');
            }
        });

        // Event Listeners
        userInput.addEventListener("input", () => {
            showSuggestions(userInput.value.trim());
        });

        userInput.addEventListener("keypress", (e) => {
            if (e.key === "Enter") {
                handleUserInput();
            }
        });

        // Toggle event listeners
        academicsToggle.addEventListener('change', updateSpeedometer);
        irToggle.addEventListener('change', updateSpeedometer);
        knowMoreBtn.addEventListener('click', showDetailsModal);
        modalClose.addEventListener('click', closeDetailsModal);
        knowMoreModal.addEventListener('click', function(e) {
            if (e.target === knowMoreModal) {
                closeDetailsModal();
            }
        });

        // Initialize question panel
        initializeQuestionPanel();

        // Show welcome message if already signed in and mode selected
        if (hasSignedIn && hasSelectedMode) {
            const userData = JSON.parse(localStorage.getItem('userData'));
            signinForm.style.display = 'none';
            modeForm.style.display = 'none';
            chatInputContainer.style.display = 'block';
            addMessage(`CloudsAI: Welcome back, ${userData.name}! How can I help you today?`);
            setTimeout(() => {
                addMessage(`CloudsAI: Need immediate help? <a href="https://chat.whatsapp.com/YOUR_GROUP_LINK" class="whatsapp-btn" target="_blank" style="display: inline-flex; margin-left: 8px;">
                    <svg xmlns="http://www.w3.org/2000/svg" class="whatsapp-icon" viewBox="0 0 24 24" fill="currentColor" style="width: 16px; height: 16px; margin-right: 6px;">
                        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-6.29 5.362c-.173.198-.341.52-.5.644-.161.125-.346.186-.495.186-.124 0-.248-.03-.372-.074-.421-.15-1.24-.619-2.336-1.773-.865-.894-1.45-1.99-1.618-2.326-.173-.341-.198-.578-.124-.744.075-.173.421-.52.644-.678.223-.161.347-.198.52-.198.174 0 .347.037.52.161.173.124.744.818.793.868.05.05.099.074.198.037.099-.037.421-.161.744-.248.324-.087.595-.037.768.099.174.136.744.818.818.992.075.174.075.347-.024.521"/>
                    </svg>
                    Join our WhatsApp
                </a>`);
            }, 500);
        } else if (hasSignedIn && !hasSelectedMode) {
            // Show mode selection if signed in but mode not selected
            signinForm.style.display = 'none';
            modeForm.style.display = 'block';
            chatInputContainer.style.display = 'none';
            // Initialize speedometer when showing mode form
            setTimeout(initSpeedometerMarks, 100);
            updateSpeedometer();
        }

        // Make selectQuickQuestion available globally
        window.selectQuickQuestion = selectQuickQuestion;
    </script>
</body>

</html>